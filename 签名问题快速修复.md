# ğŸš¨ Google ç™»å½•ç­¾åé—®é¢˜å¿«é€Ÿä¿®å¤æ€»ç»“

## âœ… é—®é¢˜ç¡®è®¤

é€šè¿‡è¿è¡Œ `verify_firebase_config.sh` å·²ç¡®è®¤é—®é¢˜ï¼š

```
âŒ oauth_client ä¸ºç©ºæ•°ç»„ â†’ å¯¼è‡´ "Sign-in canceled"
âŒ Firebase æœªé…ç½® SHA-1 æŒ‡çº¹
âŒ Web Client ID æœªé…ç½®
```

---

## ğŸ“Š å½“å‰çŠ¶æ€

### **è®¾å¤‡ä¿¡æ¯**
```
âœ… è®¾å¤‡ï¼šTECNO AB7
âœ… Android ç‰ˆæœ¬ï¼š9
âœ… åº”ç”¨å·²å®‰è£…ï¼šç‰ˆæœ¬ 1.4.1
âœ… Debug SHA-1ï¼š8A:E5:E2:C3:9E:28:4C:7C:32:77:ED:2E:89:57:BF:08:AB:4F:9E:45
```

### *
```
âŒ Firebase ä¸­æœªæ·»åŠ  Debug SHA-1
âŒ Firebase ä¸­æœªæ·»åŠ  Play Store SHA-1ï¼ˆçº¿ä¸Šç‰ˆæœ¬å¿…éœ€ï¼‰
âŒ OAuth 2.0 å®¢æˆ·ç«¯ ID æœªåˆ›å»º
âŒ Web Client ID æœªé…ç½®åˆ°ä»£ç ä¸­
```

---

## âš¡ 5æ­¥å¿«é€Ÿä¿®å¤ï¼ˆ15åˆ†é’Ÿï¼‰

### **ç¬¬ 1 æ­¥ï¼šè·å– Play Store SHA-1** â­â­â­ æœ€é‡è¦

**å¦‚æœæ‚¨çš„åº”ç”¨åœ¨ Google Play ä¸Šçº¿ï¼Œè¿™æ˜¯å¿…é¡»çš„ï¼**

1. è®¿é—® Google Play Consoleï¼š
   ```
   https://play.google.com/console/
   ```

2. æ‰¾åˆ°æ‚¨çš„åº”ç”¨ï¼ˆQuran Majeedï¼‰

3. å¯¼èˆªåˆ°ï¼š
   ```
   å·¦ä¾§èœå• â†’ Release â†’ Setup â†’ App Signing
   æˆ–
   å·¦ä¾§èœå• â†’ App Integrity â†’ App signing
   ```

4. å¤åˆ¶ **App signing key certificate** ä¸‹çš„ SHA-1

**ä¿å­˜æ­¤ SHA-1ï¼Œä¸‹ä¸€æ­¥è¦ç”¨ï¼**

---

### **ç¬¬ 2 æ­¥ï¼šåœ¨ Firebase Console æ·»åŠ  SHA-1**

1. è®¿é—® Firebase Consoleï¼š
   ```
   https://console.firebase.google.com/
   ```

2. é€‰æ‹©é¡¹ç›®ï¼š**quran-majeed-aa3d2**

3. ç‚¹å‡»é½¿è½®å›¾æ ‡ âš™ï¸ â†’ **Project Settings**

4. å‘ä¸‹æ»šåŠ¨åˆ° **Your apps** â†’ æ‰¾åˆ° Android åº”ç”¨

5. åœ¨ **SHA certificate fingerprints** éƒ¨åˆ†ï¼š

   **æ·»åŠ  Debug SHA-1**ï¼š
   ```
   ç‚¹å‡» Add fingerprint
   ç²˜è´´ï¼š8A:E5:E2:C3:9E:28:4C:7C:32:77:ED:2E:89:57:BF:08:AB:4F:9E:45
   ç‚¹å‡» Save
   ```

   **æ·»åŠ  Play Store SHA-1**ï¼š
   ```
   å†æ¬¡ç‚¹å‡» Add fingerprint
   ç²˜è´´ï¼š[æ­¥éª¤1 è·å–çš„ Play Store SHA-1]
   ç‚¹å‡» Save
   ```

---

### **ç¬¬ 3 æ­¥ï¼šå¯ç”¨ Google Sign-In**

1. åœ¨ Firebase Console ä¸­ï¼Œç‚¹å‡»å·¦ä¾§ **Authentication**

2. ç‚¹å‡» **Sign-in method** æ ‡ç­¾é¡µ

3. æ‰¾åˆ° **Google** æä¾›å•†

4. ç‚¹å‡»å®ƒå¹¶åˆ‡æ¢åˆ° **Enabled**

5. å¡«å†™ **Project support email**

6. ç‚¹å‡» **Save**

---

### **ç¬¬ 4 æ­¥ï¼šä¸‹è½½å¹¶æ›¿æ¢ google-services.json**

1. è¿”å› **Project Settings** â†’ **General** æ ‡ç­¾é¡µ

2. å‘ä¸‹æ»šåŠ¨åˆ° **Your apps** â†’ Android åº”ç”¨

3. ç‚¹å‡» **google-services.json** ä¸‹è½½æŒ‰é’®

4. åœ¨ç»ˆç«¯æ‰§è¡Œï¼š
   ```bash
   cd /Users/huwei/AndroidStudioProjects/quran0
   
   # å¤‡ä»½æ—§æ–‡ä»¶
   mv app/google-services.json app/google-services.json.backup
   
   # å¤åˆ¶æ–°æ–‡ä»¶
   cp ~/Downloads/google-services.json app/
   
   # éªŒè¯æ–°æ–‡ä»¶
   cat app/google-services.json | grep -A 10 "oauth_client"
   ```

   **å¿…é¡»çœ‹åˆ° client_idï¼Œä¸èƒ½æ˜¯ç©ºæ•°ç»„ï¼**

---

### **ç¬¬ 5 æ­¥ï¼šé…ç½® Web Client ID**

1. åœ¨ Firebase Console â†’ **Project Settings** â†’ **General**

2. å‘ä¸‹æ»šåŠ¨åˆ° **Your apps**

3. æ‰¾åˆ° **Web client (auto created by Google Service)**

4. å¤åˆ¶ **Web client ID**ï¼ˆæ ¼å¼ï¼š`123456789-xxxxx.apps.googleusercontent.com`ï¼‰

5. æ‰“å¼€æ–‡ä»¶ç¼–è¾‘å™¨ï¼Œä¿®æ”¹ï¼š
   ```
   app/src/main/java/com/quran/quranaudio/online/Utils/GoogleAuthManager.java
   ```

6. æ‰¾åˆ°ç¬¬ 46 è¡Œï¼Œæ›¿æ¢ï¼š
   ```java
   // æ›¿æ¢å‰
   .requestIdToken("YOUR_WEB_CLIENT_ID_HERE")
   
   // æ›¿æ¢åï¼ˆç²˜è´´æ‚¨çš„å®é™… Client IDï¼‰
   .requestIdToken("123456789-xxxxx.apps.googleusercontent.com")
   ```

7. ä¿å­˜æ–‡ä»¶

---

## ğŸ”„ é‡æ–°ç¼–è¯‘å’Œæµ‹è¯•

### **ç¼–è¯‘å¹¶å®‰è£…**
```bash
cd /Users/huwei/AndroidStudioProjects/quran0

# æ¸…ç†
./gradlew clean

# ç¼–è¯‘å¹¶å®‰è£…åˆ°è®¾å¤‡
./gradlew installDebug --no-daemon
```

### **éªŒè¯é…ç½®**
```bash
```

**åº”è¯¥çœ‹åˆ°**ï¼š
```
âœ… Debug SHA-1ï¼š...
âœ… åŒ…ååŒ¹é…æ­£ç¡®
âœ… oauth_client å·²é…ç½®
âœ… Web Client ID å·²é…ç½®
âœ… è®¾å¤‡å·²è¿æ¥
âœ… åº”ç”¨å·²å®‰è£…
```

### **åœ¨è®¾å¤‡ä¸Šæµ‹è¯•**

1. å¯åŠ¨åº”ç”¨ï¼ˆTECNO AB7 è®¾å¤‡ï¼‰
2. è¿›å…¥ä¸»é¡µ
3. ç‚¹å‡»å³ä¸Šè§’å¤´åƒå›¾æ ‡
4. é€‰æ‹© Google è´¦æˆ·
5. **åº”è¯¥æˆåŠŸç™»å½•ï¼**

---

## ğŸ“ æ£€æŸ¥æ¸…å•

ä¿®å¤å®Œæˆåï¼Œè¯·ç¡®è®¤ï¼š

- [ ] **æ­¥éª¤ 1**: å·²ä» Google Play Console è·å– Play Store SHA-1
- [ ] **æ­¥éª¤ 2**: å·²åœ¨ Firebase Console æ·»åŠ  Debug SHA-1
- [ ] **æ­¥éª¤ 2**: å·²åœ¨ Firebase Console æ·»åŠ  Play Store SHA-1
- [ ] **æ­¥éª¤ 3**: å·²å¯ç”¨ Google Sign-In
- [ ] **æ­¥éª¤ 4**: å·²ä¸‹è½½æ–°çš„ google-services.json
- [ ] **æ­¥éª¤ 4**: æ–°æ–‡ä»¶ä¸­ oauth_client ä¸æ˜¯ç©ºæ•°ç»„
- [ ] **æ­¥éª¤ 5**: å·²é…ç½® Web Client ID åˆ° GoogleAuthManager.java
- [ ] **ç¼–è¯‘**: å·²æ‰§è¡Œ `./gradlew clean installDebug`
- [ ] **éªŒè¯**: è¿è¡Œ `./verify_firebase_config.sh` å…¨éƒ¨é€šè¿‡
- [ ] **æµ‹è¯•**: åœ¨ TECNO AB7 è®¾å¤‡ä¸Šç™»å½•æˆåŠŸ

---

## ğŸ” å…³é”®æ¦‚å¿µ

### **ä¸ºä»€ä¹ˆéœ€è¦ä¸¤ä¸ª SHA-1ï¼Ÿ**

```
Debug SHA-1ï¼š
â”œâ”€â”€ ç”¨äºå¼€å‘æµ‹è¯•
â”œâ”€â”€ ä»æœ¬åœ° debug.keystore ç”Ÿæˆ
â””â”€â”€ å€¼ï¼š8A:E5:E2:C3:9E:28:4C:7C:32:77:ED:2E:89:57:BF:08:AB:4F:9E:45

Play Store SHA-1ï¼š
â”œâ”€â”€ ç”¨äºçº¿ä¸Šæ­£å¼ç‰ˆæœ¬
â”œâ”€â”€ Google Play é‡æ–°ç­¾ååçš„ SHA-1
â””â”€â”€ å€¼ï¼šä» Google Play Console è·å–
```

### **ä¸ºä»€ä¹ˆç™»å½•ä¼šå¤±è´¥ï¼Ÿ**

```
ç”¨æˆ·ç‚¹å‡»ç™»å½•
    â†“
Google æœåŠ¡å™¨éªŒè¯åº”ç”¨ç­¾å
    â†“
âŒ SHA-1 ä¸åœ¨ Firebase ç™½åå•ä¸­
    â†“
âŒ è¿”å› "Sign-in canceled"
```

### **æ­£ç¡®çš„é…ç½®**

```
Firebase Console å¿…é¡»åŒæ—¶æ³¨å†Œï¼š
â”œâ”€â”€ Debug SHA-1ï¼ˆå¼€å‘ç”¨ï¼‰
â””â”€â”€ Play Store SHA-1ï¼ˆçº¿ä¸Šç”¨ï¼‰â­ æœ€é‡è¦
```

---

## ğŸ†˜ å¦‚æœè¿˜æ˜¯å¤±è´¥

### **æŸ¥çœ‹è¯¦ç»†æ—¥å¿—**
```bash
adb logcat -c
# åœ¨è®¾å¤‡ä¸Šæ‰§è¡Œç™»å½•
adb logcat -d | grep -E "GoogleAuth|StatusCode"
```

### **æˆåŠŸçš„æ—¥å¿—åº”è¯¥æ˜¾ç¤º**
```
âœ… D/GoogleAuthManager: ID Token: Present
âœ… D/GoogleAuthManager: signInWithCredential:success
âœ… D/FragMain: Google Sign-In SUCCESS!
```

### **å¤±è´¥çš„æ—¥å¿—ä¼šæ˜¾ç¤º**
```
âŒ E/GoogleAuthManager: Status Code: 12501
âŒ Sign-in was canceled
```

å¦‚æœçœ‹åˆ°å¤±è´¥ï¼Œè¯·ç¡®è®¤ï¼š
1. âœ… å·²æ·»åŠ ä¸¤ä¸ª SHA-1ï¼ˆDebug å’Œ Play Storeï¼‰
2. âœ… å·²ä¸‹è½½æ–°çš„ google-services.json
3. âœ… å·²é…ç½® Web Client ID
4. âœ… å·²é‡æ–°ç¼–è¯‘åº”ç”¨

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **è¯¦ç»†ä¿®å¤æŒ‡å—**: `FIREBASE_SIGNATURE_FIX.md`
- **éªŒè¯è„šæœ¬**: `verify_firebase_config.sh`
- **è¯Šæ–­è„šæœ¬**: `diagnose_google_signin.sh`
- **å¿«é€Ÿä¿®å¤æŒ‡å—**: `å¿«é€Ÿä¿®å¤æŒ‡å—.md`

---

## âš¡ ç°åœ¨å°±å¼€å§‹ä¿®å¤ï¼

**æœ€é‡è¦çš„æ­¥éª¤**ï¼š
1. ä» Google Play Console è·å– Play Store SHA-1
2. åœ¨ Firebase Console æ·»åŠ ä¸¤ä¸ª SHA-1
3. ä¸‹è½½æ–°çš„ google-services.json

**é¢„è®¡æ—¶é—´**ï¼š15 åˆ†é’Ÿ

**ç«‹å³å¼€å§‹ï¼** ğŸš€

---

_è®¾å¤‡_ï¼šTECNO AB7 (Android 9)  
_åº”ç”¨ç‰ˆæœ¬_ï¼š1.4.1  
_Debug SHA-1_ï¼š8A:E5:E2:C3:9E:28:4C:7C:32:77:ED:2E:89:57:BF:08:AB:4F:9E:45  
_æœ€åæ›´æ–°_ï¼š2024-10-16

